
# application-agnostic anchors that specify observation errors
# applicable to Variational, HofX3D

# reusable latitude bands for all observation types
_named latitude bands:
  # 7-band
  NPol:
    min: &minNPol 60.
    max: &maxNPol 90.
  NMid:
    min: &minNMid 30.
    max: &maxNMid 60.
  NTro:
    min: &minNTro  5.
    max: &maxNTro 30.
  ITCZ:
    min: &minITCZ -5.
    max: &maxITCZ  5.
  STro:
    min: &minSTro -30.
    max: &maxSTro  -5.
  SMid:
    min: &minSMid -60.
    max: &maxSMid -30.
  SPol:
    min: &minSPol -90.
    max: &maxSPol -60.

  # 3-band
  NXTro:
    min: &minNXTro 30.
    max: &maxNXTro 90.
  Tro:
    min: &minTro -30.
    max: &maxTro  30.
  SXTro:
    min: &minSXTro -90.
    max: &maxSXTro -30.

_gnssro:
  errors:
    # heights (m) for observation error interpolation
    levels: &gnssroErrorLevels
      [ 1000.0,  2000.0,  3000.0,  4000.0,  5000.0,
        6000.0,  7000.0,  8000.0,  9000.0, 10000.0,
       11000.0, 12000.0, 13000.0, 14000.0, 15000.0,
       16000.0, 17000.0, 18000.0, 19000.0, 20000.0,
       21000.0, 22000.0, 23000.0, 24000.0, 25000.0,
       26000.0, 27000.0, 28000.0, 29000.0, 30000.0]

    # latitude band-specific ObsValue-normalized observation errors, i.e., (O-B)/O (unitless)
    # note: rows labeled "fixed" were not updated during Desrozier et al. (2005) training.
    # trained using relative DoaDob (Desroziers et al, 2005): E[{d^a_o}^T d^b_o y^-1]
    refncep:
      # retrieved and formatted using ./retrieveObsErrors/relativeObsErrors.csh
      NMid_Ref: &gnssrorefncepNMidErrors
        [0.01277, 0.009592, 0.007113, 0.005476, 0.004408,
         0.003701, 0.00332, 0.003064, 0.002931, 0.003047,
         0.003502, 0.003708, 0.003635, 0.003607, 0.003786,
         0.003941, 0.004038, 0.004095, 0.004043, 0.004051,
         0.004138, 0.004211, 0.004628, 0.00529, 0.005721,
         0.005949, 0.006023, 0.006627, 0.006827, 0.006827]
      NPol_Ref: &gnssrorefncepNPolErrors
        [0.01077, 0.007726, 0.005518, 0.00431, 0.003584,
         0.003284, 0.00324, 0.003376, 0.003485, 0.003429,
         0.003149, 0.0028, 0.002749, 0.00273, 0.002818,
         0.00294, 0.003067, 0.003116, 0.003146, 0.003101,
         0.003122, 0.003158, 0.003195, 0.003295, 0.003573,
         0.00396, 0.004307, 0.004896, 0.005286, 0.005336]
      SMid_Ref: &gnssrorefncepSMidErrors
        [0.01115, 0.008121, 0.006039, 0.004771, 0.004052,
         0.003499, 0.003059, 0.002785, 0.002645, 0.002704,
         0.003112, 0.003304, 0.003337, 0.003621, 0.003986,
         0.004007, 0.003872, 0.003659, 0.003331, 0.00312,
         0.003045, 0.003033, 0.003192, 0.003554, 0.00391,
         0.004276, 0.004636, 0.005293, 0.005738, 0.006104]
      SPol_Ref: &gnssrorefncepSPolErrors
        [0.009521, 0.007319, 0.005726, 0.004419, 0.003698,
         0.00337, 0.003276, 0.003389, 0.003674, 0.003682,
         0.003363, 0.003167, 0.003236, 0.003392, 0.00337,
         0.003397, 0.003441, 0.003487, 0.003394, 0.003402,
         0.00348, 0.003657, 0.00381, 0.004277, 0.004832,
         0.005315, 0.005835, 0.006617, 0.007574, 0.007788]
      Tro_Ref: &gnssrorefncepTroErrors
        [0.01331, 0.01057, 0.009444, 0.007683, 0.006296,
         0.005015, 0.004041, 0.003328, 0.002831, 0.002512,
         0.002726, 0.003292, 0.003994, 0.004613, 0.005477,
         0.007136, 0.009535, 0.009856, 0.009726, 0.009355,
         0.00927, 0.009689, 0.01096, 0.01366, 0.01614,
         0.0172, 0.01752, 0.0179, 0.01788, 0.0167]

    # for now train using relative omf: E[{d^f_o}^T d^f_o x y^-1]
    # change to relative DoaDob later if 3D pressure is added as a
    # linear GeoVar and gnssrobndmo can be assimilated effectively
    bndmo:
      NMid: &gnssrobndmoNMidErrors
       [999., 0.1493, 0.152, 0.1227, 0.09125, # fixed
        0.06691, 0.04735, 0.03254, 0.02368, 0.01885, # fixed
        0.01891, 0.02112, 0.02271, 0.02124, 0.01812,
        0.01527, 0.01479, 0.01479, 0.01472, 0.01392,
        0.013, 0.01247, 0.01264, 0.01274, 0.0135,
        0.01384, 0.01482, 0.01628, 0.01793, 0.01596]
      NPol: &gnssrobndmoNPolErrors
       [999., 0.09974, 0.09432, 0.082, 0.0636, # fixed
        0.0481, 0.03846, 0.03087, 0.02668, 0.02176, # fixed
        0.02066, 0.01666, 0.01344, 0.01167, 0.01091, # fixed
        0.01069, 0.01065, 0.01094, 0.01126, 0.01152, # fixed
        0.0116, 0.01185, 0.01215, 0.01178, 0.01201,
        0.01208, 0.01271, 0.01276, 0.01262, 0.01242]
      SMid: &gnssrobndmoSMidErrors
       [999., 0.1209, 0.1649, 0.1365, 0.09783, # fixed
        0.07208, 0.05003, 0.03529, 0.02542, 0.02056, # fixed
        0.02223, 0.02567, 0.0278, 0.02498, 0.0193,
        0.01787, 0.01905, 0.01812, 0.0156, 0.01397,
        0.01389, 0.01495, 0.01629, 0.01668, 0.0164,
        0.01682, 0.01796, 0.01913, 0.02133, 0.01974]
      SPol: &gnssrobndmoSPolErrors
       [999., 0.08444, 0.08818, 0.07884, 0.06415, # fixed
        0.04757, 0.03675, 0.03159, 0.02692, 0.02562, # fixed
        0.02528, 0.02064, 0.01544, 0.01273, 0.01204, # fixed
        0.01172, 0.01197, 0.01183, 0.01222, 0.01229, # fixed
        0.01287, 0.01358, 0.01499, 0.01534, 0.01604,
        0.01786, 0.02053, 0.02392, 0.02796, 0.03348]
      Tro: &gnssrobndmoTroErrors
       [999., 0.2091, 0.2425, 0.2019, 0.1523, # fixed
        0.1242, 0.0903, 0.06031, 0.04023, 0.02666, # fixed
        0.01939, 0.01653, 0.01596, 0.01801, 0.0206,
        0.02245, 0.02602, 0.03439, 0.0314, 0.02556,
        0.02274, 0.02217, 0.02322, 0.02444, 0.02551,
        0.02442, 0.02351, 0.0235, 0.02437, 0.02293]

    # trained using relative DoaDob (Desroziers et al, 2005): E[{d^a_o}^T d^b_o y^-1]
    bndropp1d:
      # retrieved and formatted using ./retrieveObsErrors/relativeObsErrors.csh
      NMid_Bnd: &gnssrobndropp1dNMidErrors
        [999.0, 0.0987, 0.1022, 0.08654, 0.06235,
         0.04209, 0.02777, 0.01937, 0.01497, 0.01336,
         0.01395, 0.01619, 0.01759, 0.01613, 0.01412,
         0.01365, 0.01388, 0.01385, 0.01392, 0.0136,
         0.01289, 0.01204, 0.01193, 0.01263, 0.01297,
         0.01282, 0.01306, 0.01289, 0.01355, 0.01287]
      NPol_Bnd: &gnssrobndropp1dNPolErrors
        [999.0, 0.0715, 0.06371, 0.04557, 0.03175,
         0.02152, 0.01552, 0.01392, 0.01559, 0.01621,
         0.01477, 0.01189, 0.01011, 0.00928, 0.008944,
         0.009037, 0.009052, 0.00925, 0.009424, 0.009384,
         0.009312, 0.009195, 0.009054, 0.008437, 0.008267,
         0.008415, 0.008534, 0.008892, 0.009658, 0.009484]
      SMid_Bnd: &gnssrobndropp1dSMidErrors
        [999.0, 0.07997, 0.1025, 0.08474, 0.05679,
         0.03838, 0.02558, 0.01816, 0.01423, 0.0135,
         0.01557, 0.01888, 0.01933, 0.01598, 0.01451,
         0.01536, 0.01656, 0.01636, 0.01533, 0.01416,
         0.01286, 0.0121, 0.01186, 0.01194, 0.01203,
         0.01175, 0.01233, 0.01279, 0.01459, 0.01449]
      SPol_Bnd: &gnssrobndropp1dSPolErrors
        [999.0, 0.05505, 0.05397, 0.04283, 0.03195,
         0.02079, 0.01506, 0.01385, 0.01528, 0.01875,
         0.01791, 0.01365, 0.01097, 0.009883, 0.00949,
         0.009592, 0.009731, 0.00973, 0.0098, 0.009767,
         0.009849, 0.009878, 0.01003, 0.01033, 0.01086,
         0.0117, 0.01304, 0.01557, 0.02007, 0.02086]
      Tro_Bnd: &gnssrobndropp1dTroErrors
        [999.0, 0.1356, 0.1555, 0.1395, 0.1035,
         0.07926, 0.05528, 0.03618, 0.02476, 0.01732,
         0.01229, 0.01011, 0.009942, 0.0115, 0.01358,
         0.01671, 0.02279, 0.03141, 0.03036, 0.02658,
         0.02401, 0.02272, 0.0225, 0.0238, 0.02437,
         0.02246, 0.0212, 0.01993, 0.02032, 0.02091]

  # latitude band-specific exclusion heights (m)
  # determined by comparison of |bias| and STD of rltv_omf, excluding where
  # |bias| >~ 1/2 STD
  # note: currently turned off by default, see variational/filters/gnssro{{OPERATOR}}.yaml
  exclusions:
    # The gnssrorefncep exclusions are justified based on cold-start forecasts initialized from GFS
    # analyses.  Above those heights, refractivity bias is negative and larger than STD in places
    # where temperature bias w.r.t. GFS analyses and sondes is negative (too cold).  Same behavior
    # is more pronounced in tropics down to lower altitudes.  Since refractivity ~ P/T, negative
    # refractivity bias should correspond to warm bias at a fixed pressure.  If one of 3D pressure
    # or density is added as analysis variable, will need to revisit this strategy.
    #
    # Refractivity is replaced as the anchor observation above the transition heights.  If not
    # replaced, then do not assimilate higher peaking AMSUA channels when using VarBC.
    # Replacement candidates include gnssrobndmo, gnssrobndropp1d, gnssrobndnbam
    # gnssrobndropp1d: exibits some of the same bias sign and similar magnitude relative to STD as
    #   gnssrorefncep above 25 km; might motivate filtering at some heights (see below)
    # gnssrobndmo (not fully functional): only modifies pressure and moisture; pressure not
    #   compatible with mpas-jedi analysis variables; could use for very small impact on upper
    #   level moisture with pressure fixed, but probably no real advantage
    # gnssrobndnbam: so far unsuccessful in cycling experiments, even for HofX3D
    refncep:
      NPol:
        min: &gnssrorefncepNPolExcludeMin 25000.
        max: &gnssrorefncepNPolExcludeMax 50000.
      NMid:
        min: &gnssrorefncepNMidExcludeMin 12000.
        max: &gnssrorefncepNMidExcludeMax 50000.
      Tro:
        min: &gnssrorefncepTroExcludeMin 11000.
        max: &gnssrorefncepTroExcludeMax 50000.
      SMid:
        min: &gnssrorefncepSMidExcludeMin 13000.
        max: &gnssrorefncepSMidExcludeMax 50000.
      SPol:
        min: &gnssrorefncepSPolExcludeMin 25000.
        max: &gnssrorefncepSPolExcludeMax 50000.

    bndropp1d:
      NPol: # not strictly necessary
        min: &gnssrobndropp1dNPolExcludeMin -99999.
        max: &gnssrobndropp1dNPolExcludeMax -9999.
      NMid:
        min: &gnssrobndropp1dNMidExcludeMin 23000.
        max: &gnssrobndropp1dNMidExcludeMax 26500.
      Tro:
        min: &gnssrobndropp1dTroExcludeMin 17000.
        max: &gnssrobndropp1dTroExcludeMax 28000.
      SMid:
        min: &gnssrobndropp1dSMidExcludeMin 15000.
        max: &gnssrobndropp1dSMidExcludeMax 20000.
      SPol:
        min: &gnssrobndropp1dSPolExcludeMin 28000.
        max: &gnssrobndropp1dSPolExcludeMax 30000.

_satwind:
  errors:
    # observation error bounds for location filterting in the variational application
    min: &satwindMinError 0.5
    max: &satwindMaxError 20.

    # pressures (Pa) for observation error interpolation
    levels: &satwindErrorLevels [10000., 20000., 30000., 40000., 50000., 65000., 80000., 100000.]
    default: &satwindDefaultError [ 2.1, 2.7, 3.0, 2.6, 2.1, 1.8, 1.6, 1.4]

    # ObsType codes correspond to NOAA practices in GSI source code (src/read_satwnd.F90)
    # [SATID]: applicable BUFR satellite ID's are listed in brackets
    # satwnd only: indicates only available via conversion from BUFR, not PrepBUFR, in obs2ioda-v2;
    #   otherwise may be available via both or only PrepBUFR
    # See https://www.nco.ncep.noaa.gov/sib/jeff/CodeFlag_0_STDv31_LOC7.html
    #240 - GOES IR SW [259, 270]; satwnd only
    #241 - India, no training data (update later)
    #242 - JMA Vis [171, 172, 173, 174]
    #243 - EUMETSAT Vis [55, 70]
    #244 - AVHRR [3, 4, 5, 206, 207, 209, 223], no tropics
    #245 - GOES IR LW [259, 270]; more data from satwnd, use for training
    #246 - GOES WV cloud top [259, 270]; more data from satwind, use for training
    #247 - GOES WV deep layer (clear) [259, 270]
    #250 - JMA WV deep layer (clear) [171, 172, 173, 174]
    #251 - GOES Vis [259, 270]; satwnd only
    #252 - JMA IR, U&V differ [171, 172, 173, 174]
    #253 - EUMETSAT IR, U&V differ [55, 70]
    #254 - EUMETSAT WV deep layer (clear), U&V differ [55, 70]
    #255 - LEOGEO, no training data (update later) [854]; satwnd only
    #257 - MODIS IR [783, 784], no tropics
    #258 - MODIS WV cloud top, U&V differ [783, 784], no tropics
    #259 - MODIS WV deep layer (clear) [783, 784], no tropics
    #260 - VIIRS IR, no training data (update later) [224, 225]

    # absolute observation errors (m/s)
    # 999. is entered where the PreQC filter (based on GSI) removes all locations, which
    # allows for a sharp transition region to zero-weighted Jo terms. If the PreQC filter is
    # removed, then heights with 999. either (1) need to have valid values or (2) need to be
    # filtered out by other means in order to avoid polluting post-processed statistics.

    # trained using DoaDob (Desroziers et al, 2005): E[{d^a_o}^T d^b_o]
    doadob by named latitude band and ObsType 2nd training:
      # retrieved and formatted using ./retrieveObsErrors/satwindObsErrors.csh
      # note: satwnd has more ObsType245 locations and satwind has more ObsType246 locations

      # satwind
      NXTro-ObsType242_U: &satwindNXTro-ObsType242_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.914, 1.71]
      NXTro-ObsType243_U: &satwindNXTro-ObsType243_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.723, 1.515]
      NXTro-ObsType246_U: &satwindNXTro-ObsType246_UError [ 3.59, 3.513, 3.478, 3.433, 3.097, 2.798, 999.0, 999.0]
      NXTro-ObsType250_U: &satwindNXTro-ObsType250_UError [ 2.986, 3.013, 2.785, 2.673, 2.525, 2.462, 999.0, 999.0]
      NXTro-ObsType252_U: &satwindNXTro-ObsType252_UError [ 2.625, 2.884, 2.727, 2.57, 2.448, 2.278, 2.215, 999.0]
      NXTro-ObsType253_U: &satwindNXTro-ObsType253_UError [ 7.244, 4.612, 4.129, 3.653, 3.34, 2.753, 2.321, 999.0]
      NXTro-ObsType254_U: &satwindNXTro-ObsType254_UError [ 9.619, 4.544, 3.989, 3.979, 3.938, 3.939, 999.0, 999.0]
      NXTro-ObsType257_U: &satwindNXTro-ObsType257_UError [ 999.0, 999.0, 3.933, 2.844, 2.661, 2.552, 2.412, 2.397]
      NXTro-ObsType258_U: &satwindNXTro-ObsType258_UError [ 999.0, 1.859, 3.179, 2.781, 2.581, 999.0, 999.0, 999.0]
      NXTro-ObsType259_U: &satwindNXTro-ObsType259_UError [ 999.0, 999.0, 3.052, 2.579, 2.418, 999.0, 999.0, 999.0]
      SXTro-ObsType242_U: &satwindSXTro-ObsType242_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.552, 1.441]
      SXTro-ObsType243_U: &satwindSXTro-ObsType243_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.347, 1.343]
      SXTro-ObsType246_U: &satwindSXTro-ObsType246_UError [ 3.02, 3.481, 3.337, 3.165, 3.308, 2.692, 999.0, 999.0]
      SXTro-ObsType250_U: &satwindSXTro-ObsType250_UError [ 3.134, 2.822, 2.568, 2.5, 2.43, 2.51, 999.0, 999.0]
      SXTro-ObsType252_U: &satwindSXTro-ObsType252_UError [ 2.734, 2.665, 2.467, 2.432, 2.496, 2.277, 2.061, 999.0]
      SXTro-ObsType253_U: &satwindSXTro-ObsType253_UError [ 5.366, 5.092, 4.06, 3.439, 3.207, 2.416, 1.852, 999.0]
      SXTro-ObsType254_U: &satwindSXTro-ObsType254_UError [ 8.726, 4.757, 3.872, 4.12, 3.907, 3.762, 999.0, 999.0]
      SXTro-ObsType257_U: &satwindSXTro-ObsType257_UError [ 999.0, 4.102, 3.16, 2.771, 2.716, 2.763, 2.649, 2.868]
      SXTro-ObsType258_U: &satwindSXTro-ObsType258_UError [ 999.0, 2.404, 3.015, 2.685, 2.659, 999.0, 999.0, 999.0]
      SXTro-ObsType259_U: &satwindSXTro-ObsType259_UError [ 999.0, 6.359, 3.448, 2.619, 2.446, 999.0, 999.0, 999.0]
      Tro-ObsType242_U: &satwindTro-ObsType242_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.477, 1.259]
      Tro-ObsType243_U: &satwindTro-ObsType243_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.477, 1.14]
      Tro-ObsType246_U: &satwindTro-ObsType246_UError [ 4.092, 3.445, 3.373, 3.4, 2.993, 2.973, 999.0, 999.0]
      Tro-ObsType250_U: &satwindTro-ObsType250_UError [ 2.562, 2.439, 2.39, 2.378, 2.367, 2.282, 999.0, 999.0]
      Tro-ObsType252_U: &satwindTro-ObsType252_UError [ 2.482, 2.372, 2.341, 2.288, 2.168, 2.063, 2.012, 999.0]
      Tro-ObsType253_U: &satwindTro-ObsType253_UError [ 4.363, 3.225, 3.719, 4.489, 3.6, 3.04, 2.601, 999.0]
      Tro-ObsType254_U: &satwindTro-ObsType254_UError [ 4.207, 3.316, 4.417, 5.594, 4.839, 4.304, 999.0, 999.0]
      NXTro-ObsType242_V: &satwindNXTro-ObsType242_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.891, 1.732]
      NXTro-ObsType243_V: &satwindNXTro-ObsType243_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.763, 1.572]
      NXTro-ObsType246_V: &satwindNXTro-ObsType246_VError [ 3.326, 3.603, 3.407, 3.275, 3.144, 2.878, 999.0, 999.0]
      NXTro-ObsType250_V: &satwindNXTro-ObsType250_VError [ 2.951, 3.204, 3.042, 2.742, 2.545, 2.479, 999.0, 999.0]
      NXTro-ObsType252_V: &satwindNXTro-ObsType252_VError [ 2.907, 3.179, 2.965, 2.651, 2.462, 2.312, 2.213, 999.0]
      NXTro-ObsType253_V: &satwindNXTro-ObsType253_VError [ 2.461, 3.691, 3.528, 3.26, 2.998, 2.454, 2.199, 999.0]
      NXTro-ObsType254_V: &satwindNXTro-ObsType254_VError [ 6.298, 3.857, 3.53, 3.686, 3.602, 3.333, 999.0, 999.0]
      NXTro-ObsType257_V: &satwindNXTro-ObsType257_VError [ 999.0, 999.0, 2.948, 2.934, 2.608, 2.617, 2.384, 2.486]
      NXTro-ObsType258_V: &satwindNXTro-ObsType258_VError [ 999.0, 6.256, 3.636, 2.827, 2.66, 999.0, 999.0, 999.0]
      NXTro-ObsType259_V: &satwindNXTro-ObsType259_VError [ 999.0, 999.0, 2.642, 2.57, 2.386, 999.0, 999.0, 999.0]
      SXTro-ObsType242_V: &satwindSXTro-ObsType242_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.633, 1.477]
      SXTro-ObsType243_V: &satwindSXTro-ObsType243_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.372, 1.324]
      SXTro-ObsType246_V: &satwindSXTro-ObsType246_VError [ 4.558, 3.642, 3.296, 2.965, 3.049, 3.051, 999.0, 999.0]
      SXTro-ObsType250_V: &satwindSXTro-ObsType250_VError [ 3.078, 2.954, 2.741, 2.68, 2.622, 2.512, 999.0, 999.0]
      SXTro-ObsType252_V: &satwindSXTro-ObsType252_VError [ 2.929, 2.885, 2.763, 2.633, 2.613, 2.241, 1.994, 999.0]
      SXTro-ObsType253_V: &satwindSXTro-ObsType253_VError [ 5.379, 4.48, 3.335, 3.008, 2.741, 2.203, 1.848, 999.0]
      SXTro-ObsType254_V: &satwindSXTro-ObsType254_VError [ 11.47, 4.23, 3.346, 3.452, 3.216, 3.181, 999.0, 999.0]
      SXTro-ObsType257_V: &satwindSXTro-ObsType257_VError [ 999.0, 3.954, 3.051, 2.816, 2.694, 2.791, 2.645, 3.141]
      SXTro-ObsType258_V: &satwindSXTro-ObsType258_VError [ 999.0, 5.64, 3.034, 2.623, 2.486, 999.0, 999.0, 999.0]
      SXTro-ObsType259_V: &satwindSXTro-ObsType259_VError [ 999.0, 5.324, 3.545, 2.607, 2.499, 999.0, 999.0, 999.0]
      Tro-ObsType242_V: &satwindTro-ObsType242_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.446, 1.251]
      Tro-ObsType243_V: &satwindTro-ObsType243_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 1.447, 1.192]
      Tro-ObsType246_V: &satwindTro-ObsType246_VError [ 4.414, 3.426, 3.227, 3.053, 3.049, 3.042, 999.0, 999.0]
      Tro-ObsType250_V: &satwindTro-ObsType250_VError [ 2.876, 2.708, 2.602, 2.428, 2.342, 2.392, 999.0, 999.0]
      Tro-ObsType252_V: &satwindTro-ObsType252_VError [ 2.801, 2.646, 2.503, 2.263, 2.083, 1.935, 1.818, 999.0]
      Tro-ObsType253_V: &satwindTro-ObsType253_VError [ 4.213, 3.107, 3.177, 3.546, 3.078, 2.556, 2.108, 999.0]
      Tro-ObsType254_V: &satwindTro-ObsType254_VError [ 4.218, 3.271, 3.79, 4.18, 4.017, 3.723, 999.0, 999.0]
      # satwnd
      NXTro-ObsType240_U: &satwindNXTro-ObsType240_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.866, 1.871, 1.614]
      NXTro-ObsType244_U: &satwindNXTro-ObsType244_UError [ 999.0, 1.441, 3.446, 3.403, 2.837, 2.457, 2.309, 2.378]
      NXTro-ObsType245_U: &satwindNXTro-ObsType245_UError [ 999.0, 3.458, 3.52, 3.588, 3.128, 2.81, 2.156, 1.538]
      NXTro-ObsType247_U: &satwindNXTro-ObsType247_UError [ 999.0, 3.774, 3.182, 2.982, 2.908, 2.76, 999.0, 999.0]
      NXTro-ObsType251_U: &satwindNXTro-ObsType251_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.462, 1.953, 1.504]
      SXTro-ObsType240_U: &satwindSXTro-ObsType240_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.351, 1.544, 1.307]
      SXTro-ObsType244_U: &satwindSXTro-ObsType244_UError [ 999.0, 4.143, 3.229, 2.95, 2.666, 2.586, 2.513, 2.746]
      SXTro-ObsType245_U: &satwindSXTro-ObsType245_UError [ 999.0, 4.178, 3.717, 3.471, 3.008, 2.495, 1.656, 1.367]
      SXTro-ObsType247_U: &satwindSXTro-ObsType247_UError [ 999.0, 4.055, 3.37, 3.12, 3.057, 2.645, 999.0, 999.0]
      SXTro-ObsType251_U: &satwindSXTro-ObsType251_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.147, 1.509, 1.334]
      Tro-ObsType240_U: &satwindTro-ObsType240_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.898, 1.383, 1.155]
      Tro-ObsType245_U: &satwindTro-ObsType245_UError [ 999.0, 3.484, 3.401, 2.758, 2.079, 1.889, 1.434, 1.177]
      Tro-ObsType247_U: &satwindTro-ObsType247_UError [ 999.0, 3.008, 2.939, 2.613, 2.458, 2.881, 999.0, 999.0]
      Tro-ObsType251_U: &satwindTro-ObsType251_UError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.963, 1.399, 1.151]
      NXTro-ObsType240_V: &satwindNXTro-ObsType240_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.329, 1.838, 1.504]
      NXTro-ObsType244_V: &satwindNXTro-ObsType244_VError [ 999.0, 2.328, 3.906, 3.355, 2.822, 2.599, 2.377, 2.42]
      NXTro-ObsType245_V: &satwindNXTro-ObsType245_VError [ 999.0, 3.352, 3.53, 3.554, 3.204, 2.825, 2.161, 1.533]
      NXTro-ObsType247_V: &satwindNXTro-ObsType247_VError [ 999.0, 3.85, 3.31, 3.113, 3.171, 2.679, 999.0, 999.0]
      NXTro-ObsType251_V: &satwindNXTro-ObsType251_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.661, 1.861, 1.51]
      SXTro-ObsType240_V: &satwindSXTro-ObsType240_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 2.631, 1.539, 1.364]
      SXTro-ObsType244_V: &satwindSXTro-ObsType244_VError [ 999.0, 3.959, 3.275, 2.993, 2.808, 2.682, 2.592, 2.923]
      SXTro-ObsType245_V: &satwindSXTro-ObsType245_VError [ 999.0, 4.148, 3.652, 3.176, 2.999, 2.499, 1.682, 1.378]
      SXTro-ObsType247_V: &satwindSXTro-ObsType247_VError [ 999.0, 4.168, 3.383, 3.086, 2.928, 3.736, 999.0, 999.0]
      SXTro-ObsType251_V: &satwindSXTro-ObsType251_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.315, 1.49, 1.298]
      Tro-ObsType240_V: &satwindTro-ObsType240_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.656, 1.401, 1.182]
      Tro-ObsType245_V: &satwindTro-ObsType245_VError [ 999.0, 2.945, 2.847, 2.193, 1.873, 1.807, 1.446, 1.183]
      Tro-ObsType247_V: &satwindTro-ObsType247_VError [ 999.0, 3.026, 2.776, 2.369, 2.258, 1.986, 999.0, 999.0]
      Tro-ObsType251_V: &satwindTro-ObsType251_VError [ 999.0, 999.0, 999.0, 999.0, 999.0, 1.713, 1.439, 1.282]

    no training data available:
      NXTro-ObsType241_U: &satwindNXTro-ObsType241_UError *satwindDefaultError
      NXTro-ObsType255_U: &satwindNXTro-ObsType255_UError *satwindDefaultError
      NXTro-ObsType260_U: &satwindNXTro-ObsType260_UError *satwindDefaultError
      Tro-ObsType241_U: &satwindTro-ObsType241_UError *satwindDefaultError
      Tro-ObsType244_U: &satwindTro-ObsType244_UError *satwindDefaultError
      Tro-ObsType255_U: &satwindTro-ObsType255_UError *satwindDefaultError
      Tro-ObsType257_U: &satwindTro-ObsType257_UError *satwindDefaultError
      Tro-ObsType258_U: &satwindTro-ObsType258_UError *satwindDefaultError
      Tro-ObsType259_U: &satwindTro-ObsType259_UError *satwindDefaultError
      Tro-ObsType260_U: &satwindTro-ObsType260_UError *satwindDefaultError
      SXTro-ObsType241_U: &satwindSXTro-ObsType241_UError *satwindDefaultError
      SXTro-ObsType255_U: &satwindSXTro-ObsType255_UError *satwindDefaultError
      SXTro-ObsType260_U: &satwindSXTro-ObsType260_UError *satwindDefaultError
      NXTro-ObsType241_V: &satwindNXTro-ObsType241_VError *satwindDefaultError
      NXTro-ObsType255_V: &satwindNXTro-ObsType255_VError *satwindDefaultError
      NXTro-ObsType260_V: &satwindNXTro-ObsType260_VError *satwindDefaultError
      Tro-ObsType241_V: &satwindTro-ObsType241_VError *satwindDefaultError
      Tro-ObsType244_V: &satwindTro-ObsType244_VError *satwindDefaultError
      Tro-ObsType255_V: &satwindTro-ObsType255_VError *satwindDefaultError
      Tro-ObsType257_V: &satwindTro-ObsType257_VError *satwindDefaultError
      Tro-ObsType258_V: &satwindTro-ObsType258_VError *satwindDefaultError
      Tro-ObsType259_V: &satwindTro-ObsType259_VError *satwindDefaultError
      Tro-ObsType260_V: &satwindTro-ObsType260_VError *satwindDefaultError
      SXTro-ObsType241_V: &satwindSXTro-ObsType241_VError *satwindDefaultError
      SXTro-ObsType255_V: &satwindSXTro-ObsType255_VError *satwindDefaultError
      SXTro-ObsType260_V: &satwindSXTro-ObsType260_VError *satwindDefaultError

_sondes:
  errors:
    # pressures (Pa) for observation error interpolation
    levels: &sondesErrorLevels [500., 1000., 2500., 5000., 10000., 20000., 30000., 40000., 50000., 65000., 80000., 100000.]

    # latitude band-specific observation errors: T (K), U (m s^-1), V (m s^-1), qv (kg/kg)

    # trained using DoaDob (Desroziers et al, 2005): E[{d^a_o}^T d^b_]
    doadob by named latitude band 2nd training:
      # retrieved and formatted using ./retrieveObsErrors/sondesObsErrors.csh
      absolute doadob:
        NXTro_T: &sondesNXTro_TError [10.3, 4.415, 1.972, 1.589, 1.456, 1.409, 0.9734, 0.7294, 0.7372, 0.8573, 1.108, 1.645]
        SXTro_T: &sondesSXTro_TError [6.559, 4.807, 3.034, 1.955, 2.017, 1.602, 0.8976, 0.7152, 0.7907, 1.013, 1.308, 1.524]
        Tro_T: &sondesTro_TError [9.36, 4.335, 2.18, 2.208, 1.891, 0.9432, 0.6834, 0.7274, 0.836, 0.9219, 1.059, 1.379]
        NXTro_U: &sondesNXTro_UError [5.276, 4.023, 2.833, 2.787, 2.89, 2.888, 2.59, 2.413, 2.273, 2.21, 2.278, 2.334]
        SXTro_U: &sondesSXTro_UError [8.19, 4.804, 3.509, 3.38, 3.743, 3.486, 2.888, 2.698, 2.486, 2.349, 2.426, 2.487]
        Tro_U: &sondesTro_UError [6.226, 4.608, 3.475, 3.611, 3.621, 3.015, 2.504, 2.385, 2.232, 2.134, 2.125, 2.225]
        NXTro_V: &sondesNXTro_VError [4.721, 3.89, 2.942, 2.832, 2.847, 2.864, 2.635, 2.467, 2.309, 2.248, 2.274, 2.334]
        SXTro_V: &sondesSXTro_VError [5.974, 4.748, 3.612, 3.509, 3.632, 3.369, 2.794, 2.636, 2.488, 2.449, 2.539, 2.53]
        Tro_V: &sondesTro_VError [5.714, 4.382, 3.426, 3.754, 3.838, 3.239, 2.687, 2.544, 2.338, 2.168, 2.072, 2.086]
      relative doadob:
        NXTro_qv: &sondesNXTro_qvError [999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 0.4134, 0.4425, 0.4718, 0.4302, 0.3387, 0.2355]
        SXTro_qv: &sondesSXTro_qvError [999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 0.3949, 0.4619, 0.5575, 0.5701, 0.4364, 0.2269]
        Tro_qv: &sondesTro_qvError [999.0, 999.0, 999.0, 999.0, 999.0, 999.0, 0.6005, 0.5775, 0.5866, 0.4386, 0.2883, 0.1604]

_aircraft:
  errors:
    # pressures (Pa) for observation error interpolation
    levels: &aircraftErrorLevels [10000., 20000., 30000., 40000., 50000., 65000., 80000., 100000.]

    # latitude band-specific observation errors: T (K), U (m s^-1), V (m s^-1), qv (kg/kg)

    # trained using DoaDob (Desroziers et al, 2005): E[{d^a_o}^T d^b_]
    doadob by named latitude band 2nd training:
      # retrieved and formatted using ./retrieveObsErrors/aircraftObsErrors.csh
      absolute doadob:
        NXTro_T: &aircraftNXTro_TError [ 2.55, 1.076, 0.8462, 0.7394, 0.7491, 0.8276, 1.016, 1.336]
        SXTro_T: &aircraftSXTro_TError [ 999.0, 1.974, 1.098, 0.9556, 0.8612, 0.8965, 1.056, 0.8808]
        Tro_T: &aircraftTro_TError [ 1.783, 0.8845, 0.7519, 0.6555, 0.6803, 0.7333, 0.8624, 1.059]
        NXTro_U: &aircraftNXTro_UError [ 3.042, 3.031, 2.873, 2.501, 2.325, 2.262, 2.325, 2.323]
        SXTro_U: &aircraftSXTro_UError [ 999.0, 3.527, 3.078, 2.809, 2.416, 2.321, 2.503, 2.409]
        Tro_U: &aircraftTro_UError [ 2.003, 2.597, 2.51, 2.199, 1.987, 1.893, 2.068, 2.059]
        NXTro_V: &aircraftNXTro_VError [ 3.666, 3.277, 3.156, 2.651, 2.448, 2.347, 2.378, 2.305]
        SXTro_V: &aircraftSXTro_VError [ 999.0, 4.515, 3.273, 2.913, 2.501, 2.383, 2.539, 2.357]
        Tro_V: &aircraftTro_VError [ 4.369, 2.795, 2.619, 2.245, 2.028, 1.902, 2.011, 1.989]
      relative doadob:
        NXTro_qv: &aircraftNXTro_qvError [ 999.0, 999.0, 0.3804, 0.4211, 0.4312, 0.4035, 0.3029, 0.1939]
        Tro_qv: &aircraftTro_qvError [ 999.0, 999.0, 0.4021, 0.4219, 0.4606, 0.428, 0.3533, 0.1717]
        SXTro_qv: &aircraftSXTro_qvError [999.0, 999.0, 0.6005, 0.5775, 0.5866, 0.4386, 0.2883, 0.1604] # no training data available, copied from sondes
