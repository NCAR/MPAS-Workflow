- obs space:
    <<: *ObsSpace
    name: amsua_metop-b
    obsdatain:
      obsfile: {{InDBDir}}/amsua_metop-b_obs_{{thisValidDate}}.h5
    obsdataout:
      obsfile: {{OutDBDir}}/{{obsPrefix}}_amsua_metop-b.h5
    simulated variables: [brightness_temperature]
    channels: &amsua_metop-b_channels 1-15
  obs error: *ObsErrorDiagonal
  obs operator:
    <<: *clearCRTMObsOperator
    obs options:
      <<: *CRTMObsOptions
      Sensor_ID: amsua_metop-b
  get values:
    <<: *GetValues
  obs filters:
  - filter: PreQC
    maxvalue: 0
  - filter: Domain Check
    where:
    - variable:
        name: sensor_zenith_angle@MetaData
      maxvalue: 45.0
#  Topography check
  - filter: Perform Action
    filter variables:
    - name: brightness_temperature
      channels: *amsua_metop-b_channels
    action:
      name: inflate error
      inflation variable:
        name: ObsErrorFactorTopoRad@ObsFunction
        channels: *amsua_metop-b_channels
        options:
          sensor: amsua_metop-b
          channels: *amsua_metop-b_channels
#  Transmittance Top Check
  - filter: Perform Action
    filter variables:
    - name: brightness_temperature
      channels: *amsua_metop-b_channels
    action:
      name: inflate error
      inflation variable:
        name: ObsErrorFactorTransmitTopRad@ObsFunction
        channels: *amsua_metop-b_channels
        options:
          channels: *amsua_metop-b_channels
#  Inter-channel check
  - filter: Bounds Check
    filter variables:
    - name: brightness_temperature
      channels: *amsua_metop-b_channels
    test variables:
    - name: InterChannelConsistencyCheck@ObsFunction
      channels: *amsua_metop-b_channels
      options:
        channels: *amsua_metop-b_channels
        sensor: amsua_metop-b
        use_flag: [ -1,  -1,  -1,  -1,  1,
                    1, -1, -1,  1,  -1,
                   -1, -1, -1, -1, -1 ]
    maxvalue: 1.0e-12
    action:
      name: reject
#  Useflag check
  - filter: Bounds Check
    filter variables:
    - name: brightness_temperature
      channels: *amsua_metop-b_channels
    test variables:
    - name: ChannelUseflagCheckRad@ObsFunction
      channels: *amsua_metop-b_channels
      options:
        channels: *amsua_metop-b_channels
        use_flag: [ -1, -1, -1, -1, 1,
                     1, -1, -1, 1, -1,
                    -1, -1, -1, -1, -1 ]
    minvalue: 1.0e-12
    action:
      name: reject
  - filter: Gaussian_Thinning
    horizontal_mesh: {{RADTHINDISTANCE}}
  - filter: GOMsaver
    filename: {{OutDBDir}}/{{geoPrefix}}_amsua_metop-b.nc4
