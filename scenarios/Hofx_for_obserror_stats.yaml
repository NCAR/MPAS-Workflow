# settings borrowed from /glade/work/liuz/pandac_hybrid/amsua_clrsky
experiment:
  name: 'Hofx_MPAS-init_gfstop60km_smooth2'

firstbackground:
  resource: "PANDAC.GFS"

hofx:
  job:
      retry: '3*PT30S'
initic:
  job:
      retry: '2*PT30S'
verifymodel:
  job:
      retry: '3*PT30S'
verifyobs:
    defaults:
      retry: '3*PT30S'

forecast:
  execute: False # the default is True
  post: [verifyobs] # use this when doing extended forecast

externalanalyses:
  resource: "GFS.PANDAC"
  resources:
    GFS:
      PANDAC: # only available 20180418T00-20180524T00
        30km:
          directory: /glade/derecho/scratch/nghido/sio-mmm/GenerateGFSAnalyses_gfstop_smooth2/ExternalAnalyses/30km
          #/glade/derecho/scratch/nghido/sio-mmm/GenerateGFSAnalyses_mpastop/ExternalAnalyses/30km
          #/glade/derecho/scratch/nghido/sio-mmm/GenerateGFSAnalyses_gfstop_smooth2/ExternalAnalyses/30km
          #/glade/derecho/scratch/nghido/sio-mmm/GenerateGFSAnalyses_gfstop_smooth5/ExternalAnalyses/30km

members:
  n: 1

model:
  outerMesh: 30km
  innerMesh: 60km
  ensembleMesh: 60km

observations:
  resource: PANDACArchiveForVarBC
  #resources:
  #  PANDACArchiveForVarBC:
  #    IODADirectory:
  #      hofx:
  #        gnssrobndropp1d: /glade/campaign/mmm/parc/jban/pandac/GenerateObs2023/Observations
  #        gnssrorefncep: /glade/campaign/mmm/parc/jban/pandac/GenerateObs2023/Observations
  #        gnssrobndmo: /glade/campaign/mmm/parc/jban/pandac/GenerateObs2023/Observations
  #        gnssrobndmo-nopseudo: /glade/campaign/mmm/parc/jban/pandac/GenerateObs2023/Observations
  #        gnssrobndnbam: /glade/campaign/mmm/parc/jban/pandac/GenerateObs2023/Observations

variational:
  execute: False
  DAType: 3dhybrid-allsky
  biasCorrection: True
  nInnerIterations: [60,60,]
  ensemble:
    forecasts:
      resource: "PANDAC.EDA"
  post: []

hofx:
  observers: [
    gnssrobndropp1d,
    gnssrorefncep,
    gnssrobndmo,
    gnssrobndmo-nopseudo,
    gnssrobndnbam,
  ]
workflow:
  first cycle point: 20180414T18
  #restart cycle point: 20180415T00
  #final cycle point: 20180420T00
  final cycle point: 20180514T18
  CyclingWindowHR: 6 # default is 6 for cycling DA
  max active cycle points: 20 # used for independent 'extendedforecast'
hpc:
  CriticalQueue: economy
  NonCriticalQueue: economy
